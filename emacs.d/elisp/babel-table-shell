(flet ((equals (cont patt)
               (if (stringp cont)
                   (string-match patt cont)))
       (remove-empties (lst)
                       (filter (lambda (cell) (not (equal "" cell)))
                               lst)))
  (mapcar 'remove-empties
          (filter (lambda (row)
                  (and (some   (lambda (cell) (equals cell include)) row)
                       (notany (lambda (cell) (equals cell exclude)) row)))
                  data)))
